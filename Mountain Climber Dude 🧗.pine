// Mountain Climber Dude ðŸ§—



//@version=5
indicator("Mountain Climber Dude ðŸ§—", overlay=true)

// --- Settings ---
lookback = input.int(50, "Rope Anchor Lookback", minval=1, tooltip="How far back to look for the highest 'clip' point.")
ropeColor = input.color(color.new(color.orange, 0), "Rope Color")
ropeWidth = input.int(2, "Rope Width")
showAnchor = input.bool(true, "Show Anchor Point ðŸ“Œ")

// --- Logic ---
// Find the highest high in the lookback period (The "Anchor" point)
highestPrice = ta.highest(high, lookback)
// Find the offset (how many bars back) that high occurred
highestOffset = ta.highestbars(high, lookback)

// Calculate coordinates
// bar_index is current bar. highestOffset is negative (e.g., -5).
// So anchorX = current index - 5
anchorX = bar_index + highestOffset 
anchorY = highestPrice
climberX = bar_index
climberY = close

// --- Visuals ---

// 1. The Climber (Label)
// We use 'var' so we update the SAME label instead of creating a new one every bar
var label climberLabel = label.new(na, na, text="ðŸ§—", style=label.style_none, textcolor=color.white, size=size.large)

// 2. The Anchor (Label)
var label anchorLabel = label.new(na, na, text="ðŸ“Œ", style=label.style_none, textcolor=color.red, size=size.normal)

// 3. The Rope (Line)
var line ropeLine = line.new(na, na, na, na, color=ropeColor, width=ropeWidth, style=line.style_solid)


// --- Update Loop (Happens every bar) ---
// We only update the drawings on the last bar to create the "animation" effect
if barstate.islast
    // Update Climber Position
//     label.set_xy(climberLabel, climberX, climberY)
//     label.set_tooltip(climberLabel, "Elevation: " + str.tostring(close, format.mintick))

    // Update Anchor Position
    if showAnchor
//         label.set_xy(anchorLabel, anchorX, anchorY)
//         label.set_text(anchorLabel, "ðŸ“Œ\n" + str.tostring(anchorY, format.mintick))
//     else
//         label.set_style(anchorLabel, label.style_none) // Hide if disabled

    // Update Rope Position
    // Connects the Anchor (Top) to the Climber (Current Price)
//     line.set_xy1(ropeLine, anchorX, anchorY)
//     line.set_xy2(ropeLine, climberX, climberY)
    
    // Dynamic Rope Logic:
    // If climber is falling (price < anchor), make rope orange/taut. 
    // If climber is climbing (price near high), make rope green/loose? 
    // (Currently keeping simple solid color, but you can add logic here!)